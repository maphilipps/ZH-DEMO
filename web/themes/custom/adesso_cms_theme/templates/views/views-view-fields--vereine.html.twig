{#
/**
 * @file
 * Theme override for Vereine (associations) view fields.
 * Modern list layout with avatars, contact info and status indicators.
 */
#}

{# Extract and clean field values #}
{% set title = fields.title.content|striptags|trim %}
{% set logo = fields.field_logo.content|striptags|trim|default(fields.field_header_image.content|striptags|trim) %}
{% set email = fields.field_directory_contact_email.content|striptags|trim|default(fields.field_email.content|striptags|trim) %}
{% set phone = fields.field_phone.content|striptags|trim %}
{% set website = fields.field_website.content|striptags|trim %}
{% set category = fields.field_directory_category.content|striptags|trim %}
{% set description = fields.field_description.content|striptags|trim %}
{% set contact_name = fields.field_directory_contact_person.content|striptags|trim|default(fields.field_contact_name.content|striptags|trim) %}
{% set contact_position = fields.field_contact_position.content|striptags|trim %}
{% set verified = fields.field_verified.content|striptags|trim == '1' %}
{% set last_updated = fields.field_last_updated.content|striptags|trim %}
{% set view_link = fields.view_node.content|striptags|trim %}

{# Modern list item layout #}
<li class="flex justify-between gap-x-6 py-5">
  <div class="flex min-w-0 gap-x-4">
    {# Logo/Avatar #}
    {% if logo %}
      <img src="{{ logo }}" 
           alt="{{ title }} Logo" 
           class="size-12 flex-none rounded-full bg-gray-50 object-cover">
    {% else %}
      {# Fallback icon if no logo #}
      <div class="size-12 flex-none rounded-full bg-gray-50 flex items-center justify-center">
        <svg class="size-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z" />
        </svg>
      </div>
    {% endif %}
    
    {# Main content #}
    <div class="min-w-0 flex-auto">
      <p class="text-sm/6 font-semibold text-gray-900">{{ title }}</p>
      <p class="mt-1 truncate text-xs/5 text-gray-500">
        {% if email %}
          {{ email }}
        {% elseif contact_name %}
          {{ contact_name }}
        {% elseif description %}
          {{ description|slice(0, 60) }}{% if description|length > 60 %}...{% endif %}
        {% endif %}
      </p>
      
      {# Filter-Badges für Kategorien #}
      <div class="mt-2 flex flex-wrap gap-1">
        {# Vereinsstatus Badge #}
        {% if fields.field_vereinsstatus.content %}
          {% set status_text = fields.field_vereinsstatus.content|render|striptags|trim %}
          {% if status_text %}
            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
              Status: {{ status_text }}
            </span>
          {% endif %}
        {% endif %}
        
        {# Vereinskategorie Badge #}
        {% if fields.field_vereinskategorie.content %}
          {% set category_text = fields.field_vereinskategorie.content|render|striptags|trim %}
          {% if category_text %}
            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
              {{ category_text }}
            </span>
          {% endif %}
        {% endif %}
        
        {# Mitgliedergrösse Badge #}
        {% if fields.field_mitgliedergroesse.content %}
          {% set size_text = fields.field_mitgliedergroesse.content|render|striptags|trim %}
          {% if size_text %}
            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
              {{ size_text }} Mitglieder
            </span>
          {% endif %}
        {% endif %}
        
        {# Zielgruppe Badge #}
        {% if fields.field_zielgruppe.content %}
          {% set target_text = fields.field_zielgruppe.content|render|striptags|trim %}
          {% if target_text %}
            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
              {{ target_text }}
            </span>
          {% endif %}
        {% endif %}
        
        {# Verifiziert Badge #}
        {% if verified %}
          <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800">
            ✓ Verifiziert
          </span>
        {% endif %}
      </div>
    </div>
  </div>
  
  {# Right side information #}
  <div class="hidden shrink-0 sm:flex sm:flex-col sm:items-end">
    {# Category or Contact Position #}
    <p class="text-sm/6 text-gray-900">
      {% if category %}
        {{ category }}
      {% elseif contact_position %}
        {{ contact_position }}
      {% endif %}
    </p>
    
    {# Status indicator or last update #}
    <div class="mt-1">
      {% if verified %}
        {# Verified indicator (like online status) #}
        <div class="flex items-center gap-x-1.5">
          <div class="flex-none rounded-full bg-emerald-500/20 p-1">
            <div class="size-1.5 rounded-full bg-emerald-500"></div>
          </div>
          <p class="text-xs/5 text-gray-500">Verifiziert</p>
        </div>
      {% elseif last_updated %}
        {# Last updated time #}
        <p class="text-xs/5 text-gray-500">
          Aktualisiert <time datetime="{{ last_updated }}">{{ last_updated }}</time>
        </p>
      {% else %}
        {# Default status #}
        <p class="text-xs/5 text-gray-500">
          {% if phone %}
            Tel: {{ phone }}
          {% elseif website %}
            <a href="{{ website }}" target="_blank" rel="noopener" class="text-blue-600 hover:text-blue-500">
              Webseite
            </a>
          {% endif %}
        </p>
      {% endif %}
    </div>
  </div>
</li>