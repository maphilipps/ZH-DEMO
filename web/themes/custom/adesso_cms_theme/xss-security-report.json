{
  "scanInfo": {
    "timestamp": "2025-08-30T16:39:14.189Z",
    "scanner": "GPZH XSS Security Scanner",
    "standard": "eCH-0194",
    "target": "GPZH Multi-Municipality Portal Components",
    "municipalities": [
      "Thalwil",
      "Thalheim",
      "Erlenbach"
    ]
  },
  "statistics": {
    "filesScanned": 112,
    "vulnerabilitiesFound": 299,
    "criticalVulnerabilities": 17,
    "highVulnerabilities": 281,
    "mediumVulnerabilities": 1,
    "lowVulnerabilities": 0
  },
  "vulnerabilitySummary": {
    "totalVulnerabilities": 299,
    "byRisk": {
      "critical": 17,
      "high": 281,
      "medium": 1,
      "low": 0
    },
    "userContentVulnerabilities": 1,
    "citizenDataAtRisk": true
  },
  "results": {
    "twigTemplates": [
      {
        "file": "components/text/text.twig",
        "component": "text",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/text/text.twig",
            "line": 26,
            "pattern": "on\\w+\\s*=\\s*[\"'][^\"']*[\"']",
            "risk": "CRITICAL",
            "category": "INLINE_EVENTS",
            "description": "Inline event handlers - potential XSS vector",
            "impact": "JavaScript execution via events",
            "swissCompliance": "WARNING",
            "match": "onContainerClasses = 'text-buttons mt-6 flex'",
            "context": "t({}) and link1.url|default('')) or (link2|default({}) and link2.url|default('')) %}\n    {% set buttonContainerClasses = 'text-buttons mt-6 flex' %}\n\n    {% if (text_layout|default('')) == 'centered' ...",
            "isUserContent": true,
            "municipalImpact": "SCRIPT_INJECTION"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.356Z"
      },
      {
        "file": "components/status-badge/status-badge.twig",
        "component": "status-badge",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/status-badge/status-badge.twig",
            "line": 122,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "Color\" \n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      {{ icons[current_config.icon]|raw }}\n    </svg>\n  {% endif %}\n  \n  <span class=\"flex-shrink-0\">{{ display_label }}</span>\n</span>...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.362Z"
      },
      {
        "file": "components/slider/slider.twig",
        "component": "slider",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/slider/slider.twig",
            "line": 48,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "HIGH",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "tems|length > 0 %}\n  <div class=\"{{ slider_classes|join(' ')|trim }}\" {{ slider_attributes|join(' ')|raw }}>\n    \n    <!-- Swiper Wrapper -->\n    <div class=\"swiper-wrapper\">\n      {% for item in safe...",
            "isUserContent": false,
            "municipalImpact": "CONTENT_INJECTION"
          }
        ],
        "riskLevel": "HIGH",
        "citizenDataAtRisk": false,
        "scanTimestamp": "2025-08-30T16:39:13.368Z"
      },
      {
        "file": "components/slider/slider-item.twig",
        "component": "slider",
        "municipality": "default",
        "vulnerabilitiesCount": 2,
        "vulnerabilities": [
          {
            "file": "components/slider/slider-item.twig",
            "line": 108,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "HIGH",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "oin(' ')|trim }}\" \n       data-slide-index=\"{{ safe_slide_index }}\"\n       {{ attributes|default('')|raw }}>\n    \n    {# Enhanced media container with responsive image support #}\n    {% if safe_media ...",
            "isUserContent": false,
            "municipalImpact": "CONTENT_INJECTION"
          },
          {
            "file": "components/slider/slider-item.twig",
            "line": 201,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "m md:text-base opacity-80 leading-relaxed prose prose-invert max-w-none\">\n              {{ safe_body|raw }}\n            </div>\n          {% endif %}\n          \n          {# Call-to-action button #}\n  ...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.373Z"
      },
      {
        "file": "components/sidebyside/sidebyside.twig",
        "component": "sidebyside",
        "municipality": "default",
        "vulnerabilitiesCount": 3,
        "vulnerabilities": [
          {
            "file": "components/sidebyside/sidebyside.twig",
            "line": 23,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "} %}\n    {% endif %}\n\n    {% if text|default('') %}\n      <div class=\"mb-2 lg:mb-4\">\n        {{ text|raw }}\n      </div>\n    {% endif %}\n\n    {% if features|default([]) and features|length > 0 %}\n    ...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          },
          {
            "file": "components/sidebyside/sidebyside.twig",
            "line": 43,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "height=\"24\" class=\"mt-[-2px]\"></i>\n              <span class=\"flex-1\">{{ feature.summary|default('')|raw }}</span>\n            </div>\n          {% endif %}\n        {% endfor %}\n      </div>\n    {% end...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          },
          {
            "file": "components/sidebyside/sidebyside.twig",
            "line": 23,
            "risk": "CRITICAL",
            "category": "USER_CONTENT_RAW",
            "description": "User content with raw filter - citizen data XSS vulnerability",
            "context": "USER_GENERATED",
            "priority": "IMMEDIATE",
            "match": "{{ text|raw }}",
            "citizenDataRisk": true,
            "swissComplianceViolation": true
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.428Z"
      },
      {
        "file": "components/main-menu/main-menu.twig",
        "component": "main-menu",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/main-menu/main-menu.twig",
            "line": 192,
            "pattern": "on\\w+\\s*=\\s*[\"'][^\"']*[\"']",
            "risk": "CRITICAL",
            "category": "INLINE_EVENTS",
            "description": "Inline event handlers - potential XSS vector",
            "impact": "JavaScript execution via events",
            "swissCompliance": "WARNING",
            "match": "on_class = 'flex-none text-gray-400 '",
            "context": "cro get_menu_icon(title, size_class = 'size-6') %}\n  {% set title_lower = title|lower %}\n  {% set icon_class = 'flex-none text-gray-400 ' ~ size_class %}\n\n  {# About/Information icons #}\n  {% if 'abou...",
            "isUserContent": true,
            "municipalImpact": "SCRIPT_INJECTION"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.622Z"
      },
      {
        "file": "components/filter/filter.html.twig",
        "component": "filter",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/filter/filter.html.twig",
            "line": 43,
            "pattern": "on\\w+\\s*=\\s*[\"'][^\"']*[\"']",
            "risk": "MEDIUM",
            "category": "INLINE_EVENTS",
            "description": "Inline event handlers - potential XSS vector",
            "impact": "JavaScript execution via events",
            "swissCompliance": "WARNING",
            "match": "ontrols=\"identifier\"",
            "context": "r\"\n                 x-bind:aria-expanded=\"isFilterActive(identifier)\"\n                 x-bind:aria-controls=\"identifier\"\n                 x-bind:aria-hidden=\"!isFilterActive(identifier)\"\n             ...",
            "isUserContent": false,
            "municipalImpact": "SCRIPT_INJECTION"
          }
        ],
        "riskLevel": "MEDIUM",
        "citizenDataAtRisk": false,
        "scanTimestamp": "2025-08-30T16:39:13.682Z"
      },
      {
        "file": "components/file-upload-preview/file-upload-preview.twig",
        "component": "file-upload-preview",
        "municipality": "default",
        "vulnerabilitiesCount": 4,
        "vulnerabilities": [
          {
            "file": "components/file-upload-preview/file-upload-preview.twig",
            "line": 97,
            "pattern": "on\\w+\\s*=\\s*[\"'][^\"']*[\"']",
            "risk": "CRITICAL",
            "category": "INLINE_EVENTS",
            "description": "Inline event handlers - potential XSS vector",
            "impact": "JavaScript execution via events",
            "swissCompliance": "WARNING",
            "match": "on_key = 'unknown'",
            "context": "file.error_message|default('') %}\n          \n          {# Determine file icon #}\n          {% set icon_key = 'unknown' %}\n          {% if file_type starts with 'image/' %}\n            {% set icon_key ...",
            "isUserContent": true,
            "municipalImpact": "SCRIPT_INJECTION"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.twig",
            "line": 99,
            "pattern": "on\\w+\\s*=\\s*[\"'][^\"']*[\"']",
            "risk": "CRITICAL",
            "category": "INLINE_EVENTS",
            "description": "Inline event handlers - potential XSS vector",
            "impact": "JavaScript execution via events",
            "swissCompliance": "WARNING",
            "match": "on_key = 'image'",
            "context": " set icon_key = 'unknown' %}\n          {% if file_type starts with 'image/' %}\n            {% set icon_key = 'image' %}\n          {% elseif file_type == 'application/pdf' or file_name ends with '.pdf'...",
            "isUserContent": true,
            "municipalImpact": "SCRIPT_INJECTION"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.twig",
            "line": 101,
            "pattern": "on\\w+\\s*=\\s*[\"'][^\"']*[\"']",
            "risk": "CRITICAL",
            "category": "INLINE_EVENTS",
            "description": "Inline event handlers - potential XSS vector",
            "impact": "JavaScript execution via events",
            "swissCompliance": "WARNING",
            "match": "on_key = 'pdf'",
            "context": "     {% elseif file_type == 'application/pdf' or file_name ends with '.pdf' %}\n            {% set icon_key = 'pdf' %}\n          {% elseif file_type starts with 'application/' or file_name matches '/\\\\...",
            "isUserContent": true,
            "municipalImpact": "SCRIPT_INJECTION"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.twig",
            "line": 103,
            "pattern": "on\\w+\\s*=\\s*[\"'][^\"']*[\"']",
            "risk": "CRITICAL",
            "category": "INLINE_EVENTS",
            "description": "Inline event handlers - potential XSS vector",
            "impact": "JavaScript execution via events",
            "swissCompliance": "WARNING",
            "match": "on_key = 'document'",
            "context": "type starts with 'application/' or file_name matches '/\\\\.(doc|docx|txt)$/' %}\n            {% set icon_key = 'document' %}\n          {% endif %}\n          \n          <div class=\"flex items-center p-3 ...",
            "isUserContent": true,
            "municipalImpact": "SCRIPT_INJECTION"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.697Z"
      },
      {
        "file": "components/download-item/download-item.twig",
        "component": "download-item",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/download-item/download-item.twig",
            "line": 35,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": " file_description %}\n          <div class=\"text-base text-gray-500\">\n            {{ file_description|raw }}\n          </div>\n        {% endif %}\n      </div>\n    </div>\n    <div class=\"inline-flex ite...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.704Z"
      },
      {
        "file": "components/damage-report-card/damage-report-card.twig",
        "component": "damage-report-card",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/damage-report-card/damage-report-card.twig",
            "line": 115,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "rounded-md text-xs font-medium {{ current_priority.classes }}\">\n            {{ current_priority.icon|raw }}\n            <span class=\"ml-1\">{{ current_priority.label }}</span>\n          </span>\n       ...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.711Z"
      },
      {
        "file": "components/carousel/carousel.twig",
        "component": "carousel",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/carousel/carousel.twig",
            "line": 68,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "HIGH",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "   <div class=\"{{ carousel_classes|join(' ')|trim }} pl-4 2xl:pl-0\" {{ carousel_attributes|join(' ')|raw }}>\n        \n        <div class=\"swiper-wrapper\">\n                {% block carousel_items %}\n  ...",
            "isUserContent": false,
            "municipalImpact": "CONTENT_INJECTION"
          }
        ],
        "riskLevel": "HIGH",
        "citizenDataAtRisk": false,
        "scanTimestamp": "2025-08-30T16:39:13.714Z"
      },
      {
        "file": "components/block-reference/block-reference.twig",
        "component": "block-reference",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/block-reference/block-reference.twig",
            "line": 27,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "f %}\n\n  {% if block_content %}\n    <div class=\"block-reference-content mt-4\">\n      {{ block_content|raw }}\n    </div>\n  {% endif %}\n</div>...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.741Z"
      },
      {
        "file": "components/badge/badge.twig",
        "component": "badge",
        "municipality": "default",
        "vulnerabilitiesCount": 2,
        "vulnerabilities": [
          {
            "file": "components/badge/badge.twig",
            "line": 57,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": " }}\" class=\"{{ badge_classes }}\">\n      {% if badge_icon %}\n        <span class=\"mr-1\">{{ badge_icon|raw }}</span>\n      {% endif %}\n      {{ badge_text }}\n      {% if is_removable %}\n        <button ...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          },
          {
            "file": "components/badge/badge.twig",
            "line": 71,
            "pattern": "\\|\\s*raw\\s*\\}",
            "risk": "CRITICAL",
            "category": "RAW_FILTER",
            "description": "Raw filter bypasses Twig auto-escaping - XSS vulnerability",
            "impact": "Direct XSS execution in browser",
            "swissCompliance": "VIOLATION",
            "match": "|raw }",
            "context": "span class=\"{{ badge_classes }}\">\n      {% if badge_icon %}\n        <span class=\"mr-1\">{{ badge_icon|raw }}</span>\n      {% endif %}\n      {{ badge_text }}\n      {% if is_removable %}\n        <button ...",
            "isUserContent": true,
            "municipalImpact": "CITIZEN_DATA_EXPOSURE"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.751Z"
      },
      {
        "file": "components/accordion/accordion-item.twig",
        "component": "accordion",
        "municipality": "default",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "components/accordion/accordion-item.twig",
            "line": 7,
            "pattern": "on\\w+\\s*=\\s*[\"'][^\"']*[\"']",
            "risk": "CRITICAL",
            "category": "INLINE_EVENTS",
            "description": "Inline event handlers - potential XSS vector",
            "impact": "JavaScript execution via events",
            "swissCompliance": "WARNING",
            "match": "ontrols=\"accordion-content-{{ (item.accordion_instance|default(loop.index))|default(1) }}\"",
            "context": "         aria-expanded=\"{{ (item.is_expanded|default(false)) ? 'true' : 'false' }}\"\n          aria-controls=\"accordion-content-{{ (item.accordion_instance|default(loop.index))|default(1) }}\"\n         ...",
            "isUserContent": true,
            "municipalImpact": "SCRIPT_INJECTION"
          }
        ],
        "riskLevel": "CRITICAL",
        "citizenDataAtRisk": true,
        "scanTimestamp": "2025-08-30T16:39:13.755Z"
      }
    ],
    "javascriptFiles": [
      {
        "file": "components/slider/slider.behavior.js",
        "vulnerabilitiesCount": 7,
        "vulnerabilities": [
          {
            "file": "components/slider/slider.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Simple PagedOne Swiper.js initialization\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Wait for Swiper to be available\n   * @param {F...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/slider/slider.behavior.js",
            "line": 96,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (index, className)",
            "context": ": sliderElement.querySelector('.swiper-pagination'),\n        clickable: true,\n        renderBullet: function (index, className) {\n          return '<span class=\"' + className +\n            '\" aria-lab...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/slider/slider.behavior.js",
            "line": 137,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "  return null;\n    }\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoSlider = {\n    attach: function (context) {\n      // Find slider elements\n      const sliderElements = once('adesso-slider'...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/slider/slider.behavior.js",
            "line": 148,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "ements.length, 'slider(s)');\n\n      // Wait for Swiper to load, then initialize\n      waitForSwiper(function() {\n        sliderElements.forEach(function(sliderElement) {\n          initializeSlider(sli...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/slider/slider.behavior.js",
            "line": 149,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(sliderElement)",
            "context": "for Swiper to load, then initialize\n      waitForSwiper(function() {\n        sliderElements.forEach(function(sliderElement) {\n          initializeSlider(sliderElement);\n        });\n      });\n    },\n\n ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/slider/slider.behavior.js",
            "line": 155,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "iderElement) {\n          initializeSlider(sliderElement);\n        });\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Cleanup Swiper ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/slider/slider.behavior.js",
            "line": 160,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(slider)",
            "context": "        const sliders = context.querySelectorAll('.adesso-slider.swiper');\n\n        sliders.forEach(function(slider) {\n          if (slider.swiperInstance) {\n            try {\n              slider.swi...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.839Z"
      },
      {
        "file": "components/site-header/site-header.behavior.js",
        "vulnerabilitiesCount": 14,
        "vulnerabilities": [
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 13,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal)",
            "context": "ch functionality\n * - Mobile menu toggle\n * - Keyboard navigation\n * - Accessibility features\n */\n\n(function (Drupal) {\n  'use strict';\n\n  /**\n   * Announce message to screen readers\n   * @param {stri...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 108,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "ializeMobileMenuWithElements(mobileToggle, mobileMenu) {\n    mobileToggle.addEventListener('click', function() {\n      const isExpanded = mobileToggle.getAttribute('aria-expanded') === 'true';\n\n      ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 126,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "   });\n\n    // Handle keyboard navigation in mobile menu\n    mobileMenu.addEventListener('keydown', function(e) {\n      if (e.key === 'Escape') {\n        mobileMenu.classList.add('hidden');\n        mo...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 153,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "opdown-toggle]');\n    dropdownTriggers.forEach(trigger => {\n      trigger.addEventListener('focus', function() {\n        // Announce available actions to screen readers\n        const hasSubmenu = trig...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 189,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "\"])'\n    );\n\n    focusableElements.forEach((element) => {\n      element.addEventListener('keydown', function(e) {\n        if (e.key === 'Tab') {\n          // Handle tab navigation within dropdowns\n   ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 255,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "if (!mobileToggle || !mobileMenu) {\n      return;\n    }\n\n    mobileToggle.addEventListener('click', function() {\n      const isExpanded = mobileToggle.getAttribute('aria-expanded') === 'true';\n\n      ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 273,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "   });\n\n    // Handle keyboard navigation in mobile menu\n    mobileMenu.addEventListener('keydown', function(e) {\n      if (e.key === 'Escape') {\n        mobileMenu.classList.add('hidden');\n        mo...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 298,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "rn;\n    }\n\n    // Focus search input when dropdown opens\n    searchToggle.addEventListener('click', function() {\n      setTimeout(() => {\n        if (!searchDropdown.classList.contains('hidden')) {\n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 307,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "0);\n    });\n\n    // Handle search input keyboard events\n    searchInput.addEventListener('keydown', function(e) {\n      if (e.key === 'Escape') {\n        closeDropdown(searchToggle, searchDropdown);\n ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 317,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "chDropdown.querySelector('form');\n    if (searchForm) {\n      searchForm.addEventListener('submit', function(e) {\n        const query = searchInput.value.trim();\n        if (!query) {\n          e.prev...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 348,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "wn) {\n        return;\n      }\n\n      // Handle click events\n      trigger.addEventListener('click', function(e) {\n        e.preventDefault();\n        toggleDropdown(trigger, dropdown);\n      });\n\n    ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 354,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "er, dropdown);\n      });\n\n      // Handle keyboard events\n      trigger.addEventListener('keydown', function(e) {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n      ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 365,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "}\n      });\n\n      // Close dropdown when clicking outside\n      document.addEventListener('click', function(e) {\n        if (!trigger.contains(e.target) && !dropdown.contains(e.target)) {\n          c...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/site-header/site-header.behavior.js",
            "line": 377,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "* Site Header behavior for Flowbite integration\n   */\n  Drupal.behaviors.siteHeader = {\n    attach: function (context) {\n      // Initialize only once per page load\n      const headers = context.query...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.845Z"
      },
      {
        "file": "components/quick-action-buttons/quick-action-buttons.js",
        "vulnerabilitiesCount": 5,
        "vulnerabilities": [
          {
            "file": "components/quick-action-buttons/quick-action-buttons.js",
            "line": 196,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = modalHtml;",
            "context": "    // Add modal to DOM\n    const modalContainer = document.createElement('div');\n    modalContainer.innerHTML = modalHtml;\n    document.body.appendChild(modalContainer);\n\n    // Initialize Alpine.js ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/quick-action-buttons/quick-action-buttons.js",
            "line": 278,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = `<div class=\"flex items-center space-x-2\">${statusIcon}</div>`;",
            "context": "inejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path></svg>';\n      \n      actionButtons.innerHTML = `<div class=\"flex items-center space-x-2\">${statusIcon}</div>`;\n    }\n  }\n\n  /**\n   * S...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/quick-action-buttons/quick-action-buttons.js",
            "line": 311,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = `\n      <div class=\"p-4 ${bgColor} rounded-lg\">\n        <div class=\"flex items-start\">\n          <div class=\"flex-shrink-0\">\n            <svg class=\"h-5 w-5 ${iconColor}\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              ${type === 'success' ? \n                '<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"></path>' :\n                type === 'error' ?\n                '<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>' :\n                '<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path>'\n              }\n            </svg>\n          </div>\n          <div class=\"ml-3 flex-1\">\n            <p class=\"text-sm font-medium text-gray-900\">${message}</p>\n          </div>\n          <div class=\"ml-4 flex-shrink-0 flex\">\n            <button class=\"close-notification rounded-md inline-flex text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\">\n              <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>\n              </svg>\n            </button>\n          </div>\n        </div>\n      </div>\n    `;",
            "context": "-600' : \n                     type === 'error' ? 'text-red-600' : 'text-blue-600';\n\n    notification.innerHTML = `\n      <div class=\"p-4 ${bgColor} rounded-lg\">\n        <div class=\"flex items-start\">\n...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/quick-action-buttons/quick-action-buttons.js",
            "line": 7,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "\n * Quick Action Buttons JavaScript\n * Handles approve/reject actions with Alpine.js and AJAX\n */\n\n(function() {\n  'use strict';\n\n  // Initialize quick action functionality\n  document.addEventListener...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/quick-action-buttons/quick-action-buttons.js",
            "line": 11,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "trict';\n\n  // Initialize quick action functionality\n  document.addEventListener('DOMContentLoaded', function() {\n    initializeQuickActions();\n  });\n\n  /**\n   * Initialize quick action buttons\n   */\n ...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.872Z"
      },
      {
        "file": "components/pricing/pricing.behavior.js",
        "vulnerabilitiesCount": 30,
        "vulnerabilities": [
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 492,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = '';",
            "context": "risonTable.querySelector('tbody');\n    if (tableBody) {\n      // Clear existing rows\n      tableBody.innerHTML = '';\n      \n      // Add plan headers\n      const headerRow = document.createElement('tr...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 496,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = '<th>Feature</th>' + \n        selectedPlans.map(plan => {\n          const planName = plan.card.querySelector('.plan-name')?.textContent || `Plan ${plan.index + 1}`;",
            "context": "    \n      // Add plan headers\n      const headerRow = document.createElement('tr');\n      headerRow.innerHTML = '<th>Feature</th>' + \n        selectedPlans.map(plan => {\n          const planName = pl...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Pricing interactive behavior with plan comparison and animations.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize pricing functionality\n   * @param {...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 51,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card, index)",
            "context": "d}\n   */\n  function initializePricingCards(pricingCards, pricingElement) {\n    pricingCards.forEach(function(card, index) {\n      const selectButton = card.querySelector('.select-plan, [data-select-pl...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 89,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": " card.getAttribute('data-billing-period') || 'monthly';\n\n    selectButton.addEventListener('click', function(e) {\n      // Prevent default if it's a form button\n      if (selectButton.type === 'button...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 97,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "}\n\n      // Add visual feedback\n      selectButton.classList.add('animate-pulse');\n      setTimeout(function() {\n        selectButton.classList.remove('animate-pulse');\n      }, 200);\n\n      // Track ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 162,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "3s ease, opacity 0.3s ease';\n    content.style.opacity = '0';\n\n    toggle.addEventListener('click', function(e) {\n      e.preventDefault();\n      \n      const isExpanded = toggle.getAttribute('aria-ex...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 189,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "ext') || 'Hide Features';\n        \n        // Clean up maxHeight after animation\n        setTimeout(function() {\n          content.style.maxHeight = 'none';\n        }, 300);\n      }\n    });\n  }\n\n  /**...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 204,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(toggle)",
            "context": "on initializeBillingToggle(toggleButtons, pricingCards, pricingElement) {\n    toggleButtons.forEach(function(toggle) {\n      toggle.addEventListener('click', function(e) {\n        const isYearly = tog...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 205,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "icingElement) {\n    toggleButtons.forEach(function(toggle) {\n      toggle.addEventListener('click', function(e) {\n        const isYearly = toggle.getAttribute('data-billing') === 'yearly' ||\n         ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 222,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": " // Add visual feedback\n        pricingElement.classList.add('prices-updating');\n        setTimeout(function() {\n          pricingElement.classList.remove('prices-updating');\n        }, 500);\n      })...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 240,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card, index)",
            "context": "\n    let selectedPlans = [];\n    \n    // Add selection checkboxes to cards\n    pricingCards.forEach(function(card, index) {\n      const checkbox = document.createElement('input');\n      checkbox.type ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 245,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "checkbox.setAttribute('aria-label', `Compare this plan`);\n      checkbox.addEventListener('change', function() {\n        updateSelectedPlans(checkbox, card, index);\n      });\n      \n      card.style.p...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 269,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "        `Compare ${selectedPlans.length} Plans`;\n    }\n\n    compareButton.addEventListener('click', function(e) {\n      e.preventDefault();\n      \n      if (selectedPlans.length < 2) {\n        showCom...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 295,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(entries)",
            "context": " {\n    // Intersection observer for scroll animations\n    const observer = new IntersectionObserver(function(entries) {\n      entries.forEach(function(entry) {\n        if (entry.isIntersecting) {\n    ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 296,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(entry)",
            "context": " animations\n    const observer = new IntersectionObserver(function(entries) {\n      entries.forEach(function(entry) {\n        if (entry.isIntersecting) {\n          // Stagger card animations\n         ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 300,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card, index)",
            "context": "ards = entry.target.querySelectorAll('.pricing-card, [data-pricing-card]');\n          cards.forEach(function(card, index) {\n            setTimeout(function() {\n              card.classList.add('animat...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 301,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "card, [data-pricing-card]');\n          cards.forEach(function(card, index) {\n            setTimeout(function() {\n              card.classList.add('animate-fade-in-up');\n            }, index * 100);\n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 329,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": " non-touch devices\n    if (!('ontouchstart' in window)) {\n      card.addEventListener('mouseenter', function() {\n        card.classList.add('transform', 'scale-105', 'shadow-xl');\n        \n        // ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 339,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "utton.classList.add('pulse-effect');\n        }\n      });\n\n      card.addEventListener('mouseleave', function() {\n        card.classList.remove('transform', 'scale-105', 'shadow-xl');\n        \n        ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 361,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "abindex', '0');\n    card.setAttribute('role', 'article');\n    \n    card.addEventListener('keydown', function(e) {\n      switch (e.key) {\n        case 'ArrowLeft':\n          e.preventDefault();\n       ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 396,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(toggle)",
            "context": "{void}\n   */\n  function updateToggleStates(toggleButtons, activeToggle) {\n    toggleButtons.forEach(function(toggle) {\n      toggle.classList.remove('active');\n      toggle.setAttribute('aria-pressed'...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 412,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card)",
            "context": "urn {void}\n   */\n  function updatePricingDisplay(pricingCards, isYearly) {\n    pricingCards.forEach(function(card) {\n      const monthlyPrice = card.querySelector('.monthly-price, [data-monthly-price]...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 445,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(priceElement)",
            "context": "icingElement.querySelectorAll('.price-amount, [data-price-amount]');\n    \n    priceElements.forEach(function(priceElement) {\n      const finalPrice = parseInt(priceElement.textContent.replace(/[^\\d]/g...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 523,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "    \n    messageElement.textContent = message;\n    \n    // Auto-hide after 5 seconds\n    setTimeout(function() {\n      if (messageElement.parentNode) {\n        messageElement.remove();\n      }\n    }, ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 587,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "d:', trackingData);\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoPricing = {\n    attach: function (context) {\n      // Find pricing elements\n      const pricingElements = once('adesso-prici...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 600,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(pricingElement)",
            "context": "esso-pricing] Found', pricingElements.length, 'pricing section(s)');\n\n      pricingElements.forEach(function(pricingElement) {\n        initializePricing(pricingElement);\n      });\n    },\n\n    detach: ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 605,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "function(pricingElement) {\n        initializePricing(pricingElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up observ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 610,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(section)",
            "context": "icing, [data-pricing], .pricing-section, .pricing-table');\n        \n        pricingSections.forEach(function(section) {\n          // Clean up intersection observer\n          if (section.pricingObserve...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pricing/pricing.behavior.js",
            "line": 619,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card)",
            "context": "nst cards = section.querySelectorAll('.pricing-card, [data-pricing-card]');\n          cards.forEach(function(card) {\n            card.classList.remove('transform', 'scale-105', 'shadow-xl', 'animate-f...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.890Z"
      },
      {
        "file": "components/pager/pager.behavior.js",
        "vulnerabilitiesCount": 34,
        "vulnerabilities": [
          {
            "file": "components/pager/pager.behavior.js",
            "line": 315,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = newPager.innerHTML;",
            "context": "gger for better UX\n      });\n      \n      // Update pager\n      if (newPager) {\n        pagerElement.innerHTML = newPager.innerHTML;\n        \n        // Re-initialize infinite scroll for new pager\n   ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 380,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = '';",
            "context": "       spinner.className = 'loading-spinner animate-spin inline-block w-4 h-4 mr-2';\n        spinner.innerHTML = '';\n        spinner.setAttribute('aria-hidden', 'true');\n        pagerElement.appendCh...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 389,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = '<div class=\"animate-spin text-2xl\"></div>';",
            "context": "g-overlay absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center';\n        overlay.innerHTML = '<div class=\"animate-spin text-2xl\"></div>';\n        overlay.style.position = 'absolut...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 423,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = newContent;",
            "context": "  container.style.transition = 'opacity 0.3s ease';\n    \n    setTimeout(function() {\n      container.innerHTML = newContent;\n      container.style.opacity = '1';\n      \n      // Clean up transition af...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 444,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = newPagerHTML;",
            "context": "rElement.style.transition = 'opacity 0.2s ease';\n    \n    setTimeout(function() {\n      pagerElement.innerHTML = newPagerHTML;\n      pagerElement.style.opacity = '1';\n      \n      setTimeout(function(...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Pager interactive behavior with AJAX loading and history management.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize pager functionality\n   * @param {El...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 58,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(link)",
            "context": "nks(pagerLinks, pagerElement, contentContainer, enableAjax, updateHistory) {\n    pagerLinks.forEach(function(link) {\n      // Skip if link is disabled or current page\n      if (link.classList.contains...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 68,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "te('aria-current', 'page');\n        }\n        return;\n      }\n\n      link.addEventListener('click', function(e) {\n        if (enableAjax && contentContainer) {\n          e.preventDefault();\n          ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 112,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(response)",
            "context": "uested-With': 'XMLHttpRequest',\n        'Content-Type': 'application/json'\n      }\n    })\n    .then(function(response) {\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${r...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 118,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(html)",
            "context": "{response.status}: ${response.statusText}`);\n      }\n      return response.text();\n    })\n    .then(function(html) {\n      // Parse response\n      const parser = new DOMParser();\n      const doc = par...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 154,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(error)",
            "context": "ger behaviors on new content\n      Drupal.behaviors.adessoPager.attach(document);\n    })\n    .catch(function(error) {\n      console.error('[adesso-pager] AJAX loading failed:', error);\n      \n      //...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 165,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "on\n      showErrorMessage(pagerElement, 'Failed to load content. Redirecting...');\n      setTimeout(function() {\n        window.location.href = url;\n      }, 1500);\n    })\n    .finally(function() {\n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 169,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "    setTimeout(function() {\n        window.location.href = url;\n      }, 1500);\n    })\n    .finally(function() {\n      setLoadingState(pagerElement, contentContainer, false);\n    });\n  }\n\n  /**\n   * I...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 185,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "d') && !link.classList.contains('current')\n    );\n    \n    pagerElement.addEventListener('keydown', function(e) {\n      const currentIndex = activeLinks.indexOf(document.activeElement);\n      let targ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 252,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(entries)",
            "context": "';\n    contentContainer.appendChild(loadingTrigger);\n\n    const observer = new IntersectionObserver(function(entries) {\n      entries.forEach(function(entry) {\n        if (entry.isIntersecting && !pag...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 253,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(entry)",
            "context": "gTrigger);\n\n    const observer = new IntersectionObserver(function(entries) {\n      entries.forEach(function(entry) {\n        if (entry.isIntersecting && !pagerElement.classList.contains('loading')) {...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 269,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "bserve(loadingTrigger);\n    \n    // Store cleanup function\n    pagerElement.infiniteScrollCleanup = function() {\n      observer.disconnect();\n      if (loadingTrigger.parentNode) {\n        loadingTrig...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 295,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(response)",
            "context": "thod: 'GET',\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    })\n    .then(function(response) {\n      return response.text();\n    })\n    .then(function(html) {\n      const par...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 298,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(html)",
            "context": "quest'\n      }\n    })\n    .then(function(response) {\n      return response.text();\n    })\n    .then(function(html) {\n      const parser = new DOMParser();\n      const doc = parser.parseFromString(html...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 307,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(item, index)",
            "context": "e}` : pagerElement.tagName);\n      \n      // Append new content items\n      newContentItems.forEach(function(item, index) {\n        setTimeout(function() {\n          contentContainer.appendChild(item....",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 308,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "/ Append new content items\n      newContentItems.forEach(function(item, index) {\n        setTimeout(function() {\n          contentContainer.appendChild(item.cloneNode(true));\n        }, index * 100); ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 320,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "Attribute('data-infinite-scroll') === 'true';\n        if (newInfiniteScroll) {\n          setTimeout(function() {\n            initializeInfiniteScroll(pagerElement, contentContainer);\n          }, 500)...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 331,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(error)",
            "context": "tLink, 'infinite_scroll', {\n        itemsLoaded: newContentItems.length\n      });\n    })\n    .catch(function(error) {\n      console.error('[adesso-pager] Infinite scroll failed:', error);\n      showEr...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 335,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": ", error);\n      showErrorMessage(pagerElement, 'Failed to load more content.');\n    })\n    .finally(function() {\n      setLoadingState(pagerElement, contentContainer, false);\n    });\n  }\n\n  /**\n   * I...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 346,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "  */\n  function initializeHistoryManagement(pagerElement) {\n    window.addEventListener('popstate', function(e) {\n      if (e.state && e.state.page) {\n        // Handle browser back/forward navigation...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 422,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "iner.style.opacity = '0';\n    container.style.transition = 'opacity 0.3s ease';\n    \n    setTimeout(function() {\n      container.innerHTML = newContent;\n      container.style.opacity = '1';\n      \n   ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 427,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "container.style.opacity = '1';\n      \n      // Clean up transition after animation\n      setTimeout(function() {\n        container.style.transition = '';\n      }, 300);\n    }, 150);\n  }\n\n  /**\n   * Up...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 443,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "style.opacity = '0.5';\n    pagerElement.style.transition = 'opacity 0.2s ease';\n    \n    setTimeout(function() {\n      pagerElement.innerHTML = newPagerHTML;\n      pagerElement.style.opacity = '1';\n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 447,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "erElement.innerHTML = newPagerHTML;\n      pagerElement.style.opacity = '1';\n      \n      setTimeout(function() {\n        pagerElement.style.transition = '';\n      }, 200);\n    }, 100);\n  }\n\n  /**\n   *...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 502,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "    }\n    \n    errorDiv.textContent = message;\n    \n    // Auto-hide after 5 seconds\n    setTimeout(function() {\n      if (errorDiv.parentNode) {\n        errorDiv.remove();\n      }\n    }, 5000);\n  }\n\n...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 546,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "ked:', trackingData);\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoPager = {\n    attach: function (context) {\n      // Find pager elements\n      const pagerElements = once('adesso-pager', \n...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 559,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(pagerElement)",
            "context": "console.log('[adesso-pager] Found', pagerElements.length, 'pager(s)');\n\n      pagerElements.forEach(function(pagerElement) {\n        initializePager(pagerElement);\n      });\n    },\n\n    detach: functi...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 564,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "rEach(function(pagerElement) {\n        initializePager(pagerElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up and re...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/pager/pager.behavior.js",
            "line": 569,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(pager)",
            "context": "rs = context.querySelectorAll('.pager, [data-pager], .pagination');\n        \n        pagers.forEach(function(pager) {\n          // Clean up infinite scroll\n          if (pager.infiniteScrollCleanup) {...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.900Z"
      },
      {
        "file": "components/newsletter-form/newsletter-form.behavior.js",
        "vulnerabilitiesCount": 16,
        "vulnerabilities": [
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Newsletter form interactive behavior with validation and AJAX submission.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize newsletter form functionality\n   * ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 62,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "ationMessage);\n    }\n\n    // Real-time validation on input\n    emailInput.addEventListener('input', function(e) {\n      clearTimeout(validationTimeout);\n      \n      // Debounce validation for better ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 66,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "ionTimeout);\n      \n      // Debounce validation for better UX\n      validationTimeout = setTimeout(function() {\n        validateEmail(emailInput, validationMessage);\n      }, 500);\n    });\n\n    // Im...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 72,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "      }, 500);\n    });\n\n    // Immediate validation on blur\n    emailInput.addEventListener('blur', function(e) {\n      clearTimeout(validationTimeout);\n      validateEmail(emailInput, validationMessa...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 78,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "idationMessage);\n    });\n\n    // Clear validation on focus\n    emailInput.addEventListener('focus', function(e) {\n      clearValidationState(emailInput, validationMessage);\n    });\n  }\n\n  /**\n   * Val...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 129,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "rmElement, emailInput, submitButton, messageContainer) {\n    formElement.addEventListener('submit', function(e) {\n      e.preventDefault();\n      \n      // Validate before submission\n      const valid...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 182,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(response)",
            "context": "y: formData,\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    })\n    .then(function(response) {\n      return response.json().then(function(data) {\n        return { status: res...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 183,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(data)",
            "context": "': 'XMLHttpRequest'\n      }\n    })\n    .then(function(response) {\n      return response.json().then(function(data) {\n        return { status: response.status, data: data };\n      });\n    })\n    .then(...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 187,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(result)",
            "context": "function(data) {\n        return { status: response.status, data: data };\n      });\n    })\n    .then(function(result) {\n      if (result.status >= 200 && result.status < 300) {\n        // Success\n     ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 196,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(error)",
            "context": "ubmissionError(formElement, submitButton, messageContainer, result.data);\n      }\n    })\n    .catch(function(error) {\n      console.error('[adesso-newsletter-form] Submission error:', error);\n      ha...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 230,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "rmElement.id || 'newsletter-form'\n    });\n    \n    // Reset button state after delay\n    setTimeout(function() {\n      setSubmissionState(submitButton, 'default');\n    }, 3000);\n  }\n\n  /**\n   * Handle...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 256,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "rmElement.id || 'newsletter-form'\n    });\n    \n    // Reset button state after delay\n    setTimeout(function() {\n      setSubmissionState(submitButton, 'default');\n    }, 3000);\n  }\n\n  /**\n   * Initia...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 519,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "ackingData);\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoNewsletterForm = {\n    attach: function (context) {\n      // Find newsletter form elements\n      const formElements = once('adesso-...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 532,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(formElement)",
            "context": "so-newsletter-form] Found', formElements.length, 'newsletter form(s)');\n\n      formElements.forEach(function(formElement) {\n        initializeNewsletterForm(formElement);\n      });\n    },\n\n    detach:...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 537,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "unction(formElement) {\n        initializeNewsletterForm(formElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up and re...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/newsletter-form/newsletter-form.behavior.js",
            "line": 542,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(form)",
            "context": "wsletter-form, [data-newsletter-form], form[action*=\"newsletter\"]');\n        \n        forms.forEach(function(form) {\n          const submitButton = form.querySelector('button[type=\"submit\"], [data-sub...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.911Z"
      },
      {
        "file": "components/mobile-menu/mobile-menu.behavior.js",
        "vulnerabilitiesCount": 9,
        "vulnerabilities": [
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 7,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "e Menu Toggle Behavior\n * Handles the mobile menu toggle functionality for the hamburger menu\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Mobile Menu Toggle behavior - Flowbite handles...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 15,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "t for any additional custom functionality\n   */\n  Drupal.behaviors.mobileMenuToggle = {\n    attach: function (context) {\n      // Flowbite handles data-collapse-toggle automatically\n      // This is j...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 20,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (button)",
            "context": "ttons = once('mobile-menu-toggle', '[data-collapse-toggle]', context);\n\n      toggleButtons.forEach(function (button) {\n        const targetId = button.getAttribute('data-collapse-toggle');\n        co...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 26,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "      // Add custom analytics or other enhancements here\n          button.addEventListener('click', function () {\n            // Announce to screen readers\n            const announcement = document.ge...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 47,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "\n   * Search Dropdown Toggle behavior\n   */\n  Drupal.behaviors.searchDropdownToggle = {\n    attach: function (context) {\n      // Find all search dropdown toggle buttons\n      const searchButtons = on...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 51,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (button)",
            "context": "ropdown-toggle', '[data-dropdown-toggle=\"search-dropdown\"]', context);\n\n      searchButtons.forEach(function (button) {\n        const dropdown = document.getElementById('search-dropdown');\n\n        if...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 55,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (e)",
            "context": "ElementById('search-dropdown');\n\n        if (dropdown) {\n          button.addEventListener('click', function (e) {\n            e.preventDefault();\n\n            // Toggle the hidden class\n            d...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 75,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (e)",
            "context": "});\n\n          // Close dropdown when clicking outside\n          document.addEventListener('click', function (e) {\n            if (!button.contains(e.target) && !dropdown.contains(e.target)) {\n       ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/mobile-menu/mobile-menu.behavior.js",
            "line": 83,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (e)",
            "context": "      });\n\n          // Close dropdown on escape key\n          document.addEventListener('keydown', function (e) {\n            if (e.key === 'Escape' && !dropdown.classList.contains('hidden')) {\n     ...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.945Z"
      },
      {
        "file": "components/main-menu/main-menu.behavior.js",
        "vulnerabilitiesCount": 23,
        "vulnerabilities": [
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Main menu interactive behavior with dropdown navigation and keyboard support.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize main menu functionality\n   * @param...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 45,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(toggle)",
            "context": "d}\n   */\n  function initializeDropdowns(dropdownToggles, menuElement) {\n    dropdownToggles.forEach(function(toggle) {\n      const dropdownId = toggle.getAttribute('data-dropdown-toggle') || \n        ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 64,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "idden', 'true');\n\n      // Click handler for dropdown toggle\n      toggle.addEventListener('click', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        \n        const isOpen...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 83,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "     if (parentItem) {\n        let hoverTimeout;\n\n        parentItem.addEventListener('mouseenter', function() {\n          clearTimeout(hoverTimeout);\n          \n          // Only open on hover for de...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 92,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "pdown(toggle, dropdown);\n          }\n        });\n\n        parentItem.addEventListener('mouseleave', function() {\n          clearTimeout(hoverTimeout);\n          hoverTimeout = setTimeout(function() {\n...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 94,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "mouseleave', function() {\n          clearTimeout(hoverTimeout);\n          hoverTimeout = setTimeout(function() {\n            if (window.innerWidth >= 768) {\n              closeDropdown(toggle, dropdow...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 104,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(item, index)",
            "context": "ems\n      const dropdownItems = dropdown.querySelectorAll('a, button');\n      dropdownItems.forEach(function(item, index) {\n        item.setAttribute('role', 'menuitem');\n        item.setAttribute('ta...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 108,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "tem');\n        item.setAttribute('tabindex', '-1');\n        \n        item.addEventListener('click', function() {\n          // Close dropdown after selection\n          closeDropdown(toggle, dropdown);\n...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 119,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "   });\n    });\n\n    // Close dropdowns when clicking outside\n    document.addEventListener('click', function(e) {\n      if (!menuElement.contains(e.target)) {\n        closeAllDropdowns(menuElement);\n ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 133,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(toggle)",
            "context": "rn {void}\n   */\n  function initializeMobileMenu(menuToggles, menuElement) {\n    menuToggles.forEach(function(toggle) {\n      const targetId = toggle.getAttribute('data-menu-toggle') ||\n               ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 144,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "    toggle.setAttribute('aria-controls', targetId);\n      }\n\n      toggle.addEventListener('click', function(e) {\n        e.preventDefault();\n        \n        const isOpen = toggle.getAttribute('aria-...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 158,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "\n      });\n    });\n\n    // Close mobile menu on escape key\n    document.addEventListener('keydown', function(e) {\n      if (e.key === 'Escape') {\n        menuToggles.forEach(function(toggle) {\n       ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 160,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(toggle)",
            "context": "dEventListener('keydown', function(e) {\n      if (e.key === 'Escape') {\n        menuToggles.forEach(function(toggle) {\n          const targetId = toggle.getAttribute('data-menu-toggle') ||\n           ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 179,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(item, index)",
            "context": "eItems = menuElement.querySelectorAll('a, button, [tabindex=\"0\"]');\n    \n    focusableItems.forEach(function(item, index) {\n      item.addEventListener('keydown', function(e) {\n        let targetIndex...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 180,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "]');\n    \n    focusableItems.forEach(function(item, index) {\n      item.addEventListener('keydown', function(e) {\n        let targetIndex;\n        \n        switch (e.key) {\n          case 'ArrowRight'...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 267,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": " \n    function handleResize() {\n      clearTimeout(resizeTimeout);\n      resizeTimeout = setTimeout(function() {\n        // Close all dropdowns on resize\n        closeAllDropdowns(menuElement);\n      ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 284,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "istener('resize', handleResize);\n    \n    // Store cleanup function\n    menuElement.resizeCleanup = function() {\n      window.removeEventListener('resize', handleResize);\n    };\n  }\n\n  /**\n   * Open d...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 322,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(item)",
            "context": "ndex for dropdown items\n    const items = dropdown.querySelectorAll('a, button');\n    items.forEach(function(item) {\n      item.setAttribute('tabindex', '-1');\n    });\n  }\n\n  /**\n   * Close all dropdo...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 336,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(toggle)",
            "context": "nToggles = menuElement.querySelectorAll('[aria-expanded=\"true\"]');\n    \n    dropdownToggles.forEach(function(toggle) {\n      if (toggle !== exceptToggle) {\n        const dropdownId = toggle.getAttribu...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 389,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "ntent = '';\n    }\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoMainMenu = {\n    attach: function (context) {\n      // Find main menu elements\n      const menuElements = once('adesso-main-m...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 402,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(menuElement)",
            "context": "e.log('[adesso-main-menu] Found', menuElements.length, 'main menu(s)');\n\n      menuElements.forEach(function(menuElement) {\n        initializeMainMenu(menuElement);\n      });\n    },\n\n    detach: funct...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 407,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "Each(function(menuElement) {\n        initializeMainMenu(menuElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up event ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/main-menu/main-menu.behavior.js",
            "line": 412,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(menu)",
            "context": "SelectorAll('.main-menu, [data-main-menu], .primary-menu, .navbar');\n        \n        menus.forEach(function(menu) {\n          // Clean up resize listener\n          if (menu.resizeCleanup) {\n         ...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.964Z"
      },
      {
        "file": "components/hero/hero.behavior.js",
        "vulnerabilitiesCount": 22,
        "vulnerabilities": [
          {
            "file": "components/hero/hero.behavior.js",
            "line": 199,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = '';",
            "context": "ontrol absolute bottom-4 right-4 bg-black bg-opacity-50 text-white p-2 rounded';\n    playPauseButton.innerHTML = '';\n    playPauseButton.setAttribute('aria-label', 'Pause background video');\n    \n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 205,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = '';",
            "context": ", function() {\n      if (videoElement.paused) {\n        videoElement.play();\n        playPauseButton.innerHTML = '';\n        playPauseButton.setAttribute('aria-label', 'Pause background video');\n   ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 209,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = '';",
            "context": "el', 'Pause background video');\n      } else {\n        videoElement.pause();\n        playPauseButton.innerHTML = '';\n        playPauseButton.setAttribute('aria-label', 'Play background video');\n    ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Hero interactive behavior with CTA tracking and parallax effects.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize hero functionality\n   * @param {Ele...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 49,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(button, index)",
            "context": "turn {void}\n   */\n  function initializeCTAButtons(ctaButtons, heroElement) {\n    ctaButtons.forEach(function(button, index) {\n      // Enhanced click tracking\n      button.addEventListener('click', fu...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 51,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "h(function(button, index) {\n      // Enhanced click tracking\n      button.addEventListener('click', function(e) {\n        const ctaData = {\n          position: index + 1,\n          text: button.textCo...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 64,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": ";\n\n        // Add visual feedback\n        button.classList.add('animate-pulse');\n        setTimeout(function() {\n          button.classList.remove('animate-pulse');\n        }, 200);\n\n        // Handle...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 82,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "       }\n      });\n\n      // Enhanced keyboard interaction\n      button.addEventListener('keydown', function(e) {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n      ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 90,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": ".click();\n        }\n      });\n\n      // Add focus management\n      button.addEventListener('focus', function() {\n        button.classList.add('ring-2', 'ring-blue-500', 'ring-opacity-50');\n      });\n\n...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 94,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "add('ring-2', 'ring-blue-500', 'ring-opacity-50');\n      });\n\n      button.addEventListener('blur', function() {\n        button.classList.remove('ring-2', 'ring-blue-500', 'ring-opacity-50');\n      })...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 145,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "arallaxUpdate, { passive: true });\n\n    // Store cleanup function\n    heroElement.parallaxCleanup = function() {\n      window.removeEventListener('scroll', requestParallaxUpdate);\n      window.removeE...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 160,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(entries)",
            "context": "lement, heroContent) {\n    if (!heroContent) return;\n\n    const observer = new IntersectionObserver(function(entries) {\n      entries.forEach(function(entry) {\n        if (entry.isIntersecting) {\n    ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 161,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(entry)",
            "context": "t) return;\n\n    const observer = new IntersectionObserver(function(entries) {\n      entries.forEach(function(entry) {\n        if (entry.isIntersecting) {\n          // Hero is visible - trigger entry a...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 168,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(element, index)",
            "context": "ents = heroContent.querySelectorAll('h1, h2, p, .cta-button');\n          animatableElements.forEach(function(element, index) {\n            setTimeout(function() {\n              element.classList.add('...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 169,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "ta-button');\n          animatableElements.forEach(function(element, index) {\n            setTimeout(function() {\n              element.classList.add('animate-fade-in');\n            }, index * 100);\n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 202,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "tribute('aria-label', 'Pause background video');\n    \n    playPauseButton.addEventListener('click', function() {\n      if (videoElement.paused) {\n        videoElement.play();\n        playPauseButton.i...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 218,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "Button);\n    \n    // Handle video load errors gracefully\n    videoElement.addEventListener('error', function() {\n      console.warn('[adesso-hero] Video background failed to load');\n      videoElement...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 280,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "cked:', trackingData);\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoHero = {\n    attach: function (context) {\n      // Find hero elements\n      const heroElements = once('adesso-hero', \n   ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 293,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(heroElement)",
            "context": "ole.log('[adesso-hero] Found', heroElements.length, 'hero section(s)');\n\n      heroElements.forEach(function(heroElement) {\n        initializeHero(heroElement);\n      });\n    },\n\n    detach: function ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 298,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": ".forEach(function(heroElement) {\n        initializeHero(heroElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up observ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 303,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(hero)",
            "context": "uerySelectorAll('.hero, [data-hero], .hero-section, .hero-banner');\n        \n        heroes.forEach(function(hero) {\n          // Clean up parallax\n          if (hero.parallaxCleanup) {\n            he...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/hero/hero.behavior.js",
            "line": 324,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(control)",
            "context": "     const videoControls = hero.querySelectorAll('.video-control');\n          videoControls.forEach(function(control) {\n            control.remove();\n          });\n        });\n      }\n    }\n  };\n\n})(D...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:13.980Z"
      },
      {
        "file": "components/file-upload-preview/file-upload-preview.behavior.js",
        "vulnerabilitiesCount": 8,
        "vulnerabilities": [
          {
            "file": "components/file-upload-preview/file-upload-preview.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, Alpine)",
            "context": "/**\n * @file\n * File Upload Preview behavior for Alpine.js integration.\n */\n\n(function (Drupal, Alpine) {\n  'use strict';\n\n  /**\n   * File Upload Preview behavior.\n   *\n   * Prov...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.behavior.js",
            "line": 16,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings)",
            "context": "cking for Infrastructure Damage Reports.\n   */\n  Drupal.behaviors.fileUploadPreview = {\n    attach: function (context, settings) {\n      // Initialize Alpine.js component data\n      this.initializeAlp...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.behavior.js",
            "line": 40,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "Initialize Alpine.js component data for file upload preview.\n     */\n    initializeAlpineComponent: function() {\n      if (typeof Alpine !== 'undefined' && typeof document !== 'undefined') {\n        d...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.behavior.js",
            "line": 183,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (component)",
            "context": " @param {Element} component - The file upload component element.\n     */\n    initializeDragAndDrop: function (component) {\n      const uploadArea = component.querySelector('.border-dashed');\n      \n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.behavior.js",
            "line": 212,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (e)",
            "context": "fault drag behaviors.\n     *\n     * @param {Event} e - The drag event.\n     */\n    preventDefaults: function (e) {\n      e.preventDefault();\n      e.stopPropagation();\n    },\n\n    /**\n     * Highlight...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.behavior.js",
            "line": 222,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (e)",
            "context": "     * Highlight drop area.\n     *\n     * @param {Event} e - The drag event.\n     */\n    highlight: function (e) {\n      e.currentTarget.classList.add('border-blue-400', 'bg-blue-50');\n    },\n\n    /**...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.behavior.js",
            "line": 231,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (e)",
            "context": "highlight from drop area.\n     *\n     * @param {Event} e - The drag event.\n     */\n    unhighlight: function (e) {\n      e.currentTarget.classList.remove('border-blue-400', 'bg-blue-50');\n    },\n\n    ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/file-upload-preview/file-upload-preview.behavior.js",
            "line": 240,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (e)",
            "context": "   * Handle dropped files.\n     *\n     * @param {Event} e - The drop event.\n     */\n    handleDrop: function (e) {\n      const dt = e.dataTransfer;\n      const files = dt.files;\n\n      // Trigger Alpi...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.018Z"
      },
      {
        "file": "components/download-item/download-item.behavior.js",
        "vulnerabilitiesCount": 10,
        "vulnerabilities": [
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Download item interactive behavior with progress tracking.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize download item functionality\n   * @p...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 27,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "    return;\n    }\n\n    // Add enhanced download tracking\n    downloadLink.addEventListener('click', function(e) {\n      const url = downloadLink.href;\n      const isExternalDownload = !url.startsWith(...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 54,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "lement);\n    });\n\n    // Enhanced keyboard interaction\n    downloadLink.addEventListener('keydown', function(e) {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        do...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 94,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "n (in real app, use actual progress)\n    let progress = 0;\n    const progressInterval = setInterval(function() {\n      progress += Math.random() * 15;\n      \n      if (progress >= 100) {\n        progr...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 108,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": " = 'Download complete!';\n        }\n        \n        // Hide progress after delay\n        setTimeout(function() {\n          progressBar.style.display = 'none';\n          if (statusText) {\n            s...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 238,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "  \n      // Add visual feedback\n      countElement.classList.add('animate-pulse');\n      setTimeout(function() {\n        countElement.classList.remove('animate-pulse');\n      }, 1000);\n    }\n  }\n\n  /*...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 271,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "trackingData);\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoDownloadItem = {\n    attach: function (context) {\n      // Find download item elements\n      const downloadElements = once('adess...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 284,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(downloadElement)",
            "context": "ownload-item] Found', downloadElements.length, 'download item(s)');\n\n      downloadElements.forEach(function(downloadElement) {\n        initializeDownloadItem(downloadElement);\n      });\n    },\n\n    d...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 289,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "n(downloadElement) {\n        initializeDownloadItem(downloadElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up progre...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/download-item/download-item.behavior.js",
            "line": 294,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(item)",
            "context": "All('.download-item, [data-download-item], .file-download');\n        \n        downloadItems.forEach(function(item) {\n          const progressBar = item.querySelector('.download-progress');\n          c...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.024Z"
      },
      {
        "file": "components/carousel/carousel.behavior.js",
        "vulnerabilitiesCount": 13,
        "vulnerabilities": [
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Carousel behavior using Swiper.js.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  Drupal.behaviors.carouselBehavior = {\n    attach: funct...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 10,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "*/\n\n(function (Drupal, once) {\n  'use strict';\n\n  Drupal.behaviors.carouselBehavior = {\n    attach: function (context) {\n      // Initialize all carousel instances using once for proper initialization...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 12,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (carousel)",
            "context": "oper initialization\n      once('carousel-swiper', '[data-swiper-carousel=\"true\"]', context).forEach(function (carousel) {\n        // Skip if Swiper is not available\n        if (typeof Swiper === 'unde...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 120,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "ed: 600,\n          effect: 'slide',\n\n          // Event callbacks\n          on: {\n            init: function () {\n              // Add custom ARIA live region for announcements\n              const liv...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 140,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "arousel.setAttribute('data-swiper-initialized', 'swiper');\n            },\n\n            slideChange: function () {\n              const currentIndex = this.realIndex + 1;\n              const totalSlides...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 159,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "`;\n                  }\n                }\n              }\n            },\n\n            autoplayStart: function () {\n              // Handle autoplay state for accessibility\n              if (this.naviga...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 169,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "el', 'Previous slide (autoplay active)');\n              }\n            },\n\n            autoplayStop: function () {\n              // Handle autoplay state for accessibility\n              if (this.naviga...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 190,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (e)",
            "context": "rn;\n        }\n\n        // Enhanced keyboard navigation\n        carousel.addEventListener('keydown', function (e) {\n          switch (e.key) {\n            case 'Home':\n              e.preventDefault();...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 212,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (element)",
            "context": ".querySelectorAll('a, button, [tabindex=\"0\"], [tabindex=\"-1\"]');\n\n        focusableElements.forEach(function (element) {\n          element.addEventListener('focus', function () {\n            if (autop...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 213,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "\n        focusableElements.forEach(function (element) {\n          element.addEventListener('focus', function () {\n            if (autoplay && swiper.autoplay) {\n              swiper.autoplay.stop();\n ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 219,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "    swiper.autoplay.stop();\n            }\n          });\n\n          element.addEventListener('blur', function () {\n            if (autoplay && swiper.autoplay && !carousel.matches(':hover')) {\n        ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 239,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "        carousel.setAttribute('data-swiper-error', 'true');\n        }\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up Swiper...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/carousel/carousel.behavior.js",
            "line": 243,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (carousel)",
            "context": "rousels = context.querySelectorAll('[data-swiper-initialized=\"swiper\"]');\n        carousels.forEach(function (carousel) {\n          if (carousel.swiperInstance) {\n            carousel.swiperInstance.d...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.050Z"
      },
      {
        "file": "components/card-group/card-group.behavior.js",
        "vulnerabilitiesCount": 23,
        "vulnerabilities": [
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Card group interactive behavior with filtering and sorting.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize card group functionality\n   * @para...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 31,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(button)",
            "context": " // Initialize filter functionality\n    if (filterButtons.length > 0) {\n      filterButtons.forEach(function(button) {\n        button.addEventListener('click', function(e) {\n          e.preventDefault...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 32,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "ngth > 0) {\n      filterButtons.forEach(function(button) {\n        button.addEventListener('click', function(e) {\n          e.preventDefault();\n          \n          const filterValue = button.getAttri...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 38,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(btn)",
            "context": "'data-filter');\n          \n          // Update active filter button\n          filterButtons.forEach(function(btn) {\n            btn.classList.remove('active', 'bg-blue-600', 'text-white');\n           ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 59,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(button)",
            "context": "}\n\n    // Initialize sort functionality\n    if (sortButtons.length > 0) {\n      sortButtons.forEach(function(button) {\n        button.addEventListener('click', function(e) {\n          e.preventDefault...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 60,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "length > 0) {\n      sortButtons.forEach(function(button) {\n        button.addEventListener('click', function(e) {\n          e.preventDefault();\n          \n          const sortValue = button.getAttribu...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 66,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(btn)",
            "context": "ibute('data-sort');\n          \n          // Update active sort button\n          sortButtons.forEach(function(btn) {\n            btn.classList.remove('active');\n            btn.setAttribute('aria-press...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 87,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "\n    if (searchInput) {\n      let searchTimeout;\n      \n      searchInput.addEventListener('input', function(e) {\n        clearTimeout(searchTimeout);\n        \n        // Debounce search for better pe...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 91,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "out);\n        \n        // Debounce search for better performance\n        searchTimeout = setTimeout(function() {\n          searchTerm = e.target.value.toLowerCase().trim();\n          applyFiltersAndSo...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 101,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": " 300);\n      });\n\n      // Clear search on Escape key\n      searchInput.addEventListener('keydown', function(e) {\n        if (e.key === 'Escape') {\n          searchInput.value = '';\n          searchTe...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 115,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card)",
            "context": "}\n     */\n    function applyFiltersAndSort() {\n      const filteredCards = Array.from(cards).filter(function(card) {\n        // Apply category filter\n        if (currentFilter !== 'all') {\n          c...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 143,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(a, b)",
            "context": "});\n\n      // Sort filtered cards\n      if (currentSort !== 'default') {\n        filteredCards.sort(function(a, b) {\n          switch (currentSort) {\n            case 'title':\n              const titl...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 167,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card, index)",
            "context": "rn 0;\n          }\n        });\n      }\n\n      // Apply visibility with animation\n      cards.forEach(function(card, index) {\n        const shouldShow = filteredCards.includes(card);\n        \n        if...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 175,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "List.remove('hidden');\n          \n          // Stagger animation for better UX\n          setTimeout(function() {\n            card.style.opacity = '1';\n            card.style.transform = 'translateY(0)...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 183,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "opacity = '0';\n          card.style.transform = 'translateY(20px)';\n          \n          setTimeout(function() {\n            card.style.display = 'none';\n            card.classList.add('hidden');\n    ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 193,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card)",
            "context": ".length > 0) {\n        const container = filteredCards[0].parentNode;\n        filteredCards.forEach(function(card) {\n          container.appendChild(card);\n        });\n      }\n    }\n\n    /**\n     * Ge...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 204,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card)",
            "context": "of visible cards\n     */\n    function getVisibleCardCount() {\n      return Array.from(cards).filter(function(card) {\n        return card.style.display !== 'none' && !card.classList.contains('hidden');...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 262,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card)",
            "context": "on.textContent = message;\n    }\n\n    // Add CSS transitions for smooth animations\n    cards.forEach(function(card) {\n      card.style.transition = 'opacity 0.3s ease, transform 0.3s ease';\n    });\n\n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 271,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "length, 'cards');\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoCardGroup = {\n    attach: function (context) {\n      // Find card group containers\n      const cardGroupElements = once('adess...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 284,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(cardGroupElement)",
            "context": "so-card-group] Found', cardGroupElements.length, 'card group(s)');\n\n      cardGroupElements.forEach(function(cardGroupElement) {\n        initializeCardGroup(cardGroupElement);\n      });\n    },\n\n    de...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 289,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "on(cardGroupElement) {\n        initializeCardGroup(cardGroupElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up and re...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 294,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(cardGroup)",
            "context": "electorAll('.card-group, [data-card-group], .cards-container');\n        \n        cardGroups.forEach(function(cardGroup) {\n          const cards = cardGroup.querySelectorAll('.card-item, [data-card]');...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/card-group/card-group.behavior.js",
            "line": 297,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(card)",
            "context": "t cards = cardGroup.querySelectorAll('.card-item, [data-card]');\n          \n          cards.forEach(function(card) {\n            // Reset inline styles\n            card.style.display = '';\n           ...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.090Z"
      },
      {
        "file": "components/button/button.behavior.js",
        "vulnerabilitiesCount": 15,
        "vulnerabilities": [
          {
            "file": "components/button/button.behavior.js",
            "line": 108,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = '';",
            "context": "       spinner.className = 'loading-spinner animate-spin inline-block w-4 h-4 mr-2';\n        spinner.innerHTML = '';\n        button.insertBefore(spinner, button.firstChild);\n      }\n      \n      // U...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Button interactive behavior with loading states and analytics.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize button functionality\n   * @param {E...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 20,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "default';\n    \n    // Add enhanced interaction feedback\n    buttonElement.addEventListener('click', function(e) {\n      // Prevent double clicks during loading\n      if (buttonElement.classList.contai...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 29,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "\n\n      // Add click animation\n      buttonElement.classList.add('animate-pulse');\n      setTimeout(function() {\n        buttonElement.classList.remove('animate-pulse');\n      }, 150);\n\n      // Handl...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 48,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "\n        // Reset loading state on form error or completion\n        form.addEventListener('submit', function() {\n          setTimeout(function() {\n            setLoadingState(buttonElement, false, ori...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 49,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": " form error or completion\n        form.addEventListener('submit', function() {\n          setTimeout(function() {\n            setLoadingState(buttonElement, false, originalText);\n          }, 2000);\n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 60,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "riant);\n    });\n\n    // Enhanced keyboard interaction\n    buttonElement.addEventListener('keydown', function(e) {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        bu...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 68,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "   }\n    });\n\n    // Focus management for accessibility\n    buttonElement.addEventListener('focus', function() {\n      buttonElement.classList.add('focus-visible:ring-2', 'focus-visible:ring-blue-500'...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 72,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "isible:ring-2', 'focus-visible:ring-blue-500');\n    });\n\n    buttonElement.addEventListener('blur', function() {\n      buttonElement.classList.remove('focus-visible:ring-2', 'focus-visible:ring-blue-5...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 77,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(mutations)",
            "context": "blue-500');\n    });\n\n    // Handle disabled state changes\n    const observer = new MutationObserver(function(mutations) {\n      mutations.forEach(function(mutation) {\n        if (mutation.attributeNam...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 78,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(mutation)",
            "context": "ate changes\n    const observer = new MutationObserver(function(mutations) {\n      mutations.forEach(function(mutation) {\n        if (mutation.attributeName === 'disabled') {\n          updateDisabledSt...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 177,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "acked:', clickData);\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoButton = {\n    attach: function (context) {\n      // Find button elements (both <button> and <a> with button classes)\n     ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 190,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(buttonElement)",
            "context": "ole.log('[adesso-button] Found', buttonElements.length, 'button(s)');\n\n      buttonElements.forEach(function(buttonElement) {\n        initializeButton(buttonElement);\n      });\n    },\n\n    detach: fun...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 195,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "ch(function(buttonElement) {\n        initializeButton(buttonElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up observ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/button/button.behavior.js",
            "line": 200,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(button)",
            "context": "onst buttons = context.querySelectorAll('button, a.btn, .button');\n        \n        buttons.forEach(function(button) {\n          // Clean up mutation observer\n          if (button.buttonObserver) {\n  ...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.127Z"
      },
      {
        "file": "components/bento-grid/bento-grid.behavior.js",
        "vulnerabilitiesCount": 14,
        "vulnerabilities": [
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Bento Grid component behaviors.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Bento Grid behavior.\n   *\n   * @type {Drupal~b...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 18,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings)",
            "context": "s bento grid functionality to relevant elements.\n   */\n  Drupal.behaviors.bentoGrid = {\n    attach: function (context, settings) {\n      const bentoGrids = once('bento-grid-processed', '[data-bento-gr...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 21,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (grid)",
            "context": "Grids = once('bento-grid-processed', '[data-bento-grid]', context);\n      \n      bentoGrids.forEach(function (grid) {\n        // Initialize any interactive features\n        initializeGrid(grid);\n     ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 37,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (item)",
            "context": "d items\n    const gridItems = grid.querySelectorAll('[data-grid-item]');\n    \n    gridItems.forEach(function (item) {\n      item.addEventListener('mouseenter', function () {\n        item.classList.add...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 38,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "rid-item]');\n    \n    gridItems.forEach(function (item) {\n      item.addEventListener('mouseenter', function () {\n        item.classList.add('hovered');\n      });\n      \n      item.addEventListener('m...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 42,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "{\n        item.classList.add('hovered');\n      });\n      \n      item.addEventListener('mouseleave', function () {\n        item.classList.remove('hovered');\n      });\n    });\n\n    // Handle responsive ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 60,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (entries)",
            "context": "er element.\n   */\n  function handleResponsiveLayout(grid) {\n    const observer = new ResizeObserver(function (entries) {\n      entries.forEach(function (entry) {\n        const width = entry.contentRec...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 61,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (entry)",
            "context": "veLayout(grid) {\n    const observer = new ResizeObserver(function (entries) {\n      entries.forEach(function (entry) {\n        const width = entry.contentRect.width;\n        \n        // Add size-based...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 89,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (block)",
            "context": "hting(grid) {\n    const codeBlocks = grid.querySelectorAll('pre code');\n    \n    codeBlocks.forEach(function (block) {\n      // Add basic syntax highlighting classes if a library like Prism.js is avai...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 111,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "ton.setAttribute('aria-label', 'Copy code to clipboard');\n    \n    button.addEventListener('click', function () {\n      navigator.clipboard.writeText(codeBlock.textContent).then(function () {\n        ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 112,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "ventListener('click', function () {\n      navigator.clipboard.writeText(codeBlock.textContent).then(function () {\n        button.textContent = 'Copied!';\n        setTimeout(function () {\n          but...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 114,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "odeBlock.textContent).then(function () {\n        button.textContent = 'Copied!';\n        setTimeout(function () {\n          button.textContent = 'Copy';\n        }, 2000);\n      }).catch(function () {\n...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 117,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "   setTimeout(function () {\n          button.textContent = 'Copy';\n        }, 2000);\n      }).catch(function () {\n        // Fallback for older browsers\n        const selection = window.getSelection()...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/bento-grid/bento-grid.behavior.js",
            "line": 128,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ()",
            "context": "   selection.removeAllRanges();\n        \n        button.textContent = 'Copied!';\n        setTimeout(function () {\n          button.textContent = 'Copy';\n        }, 2000);\n      });\n    });\n\n    // Add...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.135Z"
      },
      {
        "file": "components/accordion/accordion.behavior.js",
        "vulnerabilitiesCount": 12,
        "vulnerabilities": [
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "/**\n * @file\n * Accordion interactive behavior with Flowbite integration.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Initialize accordion functionality\n   * @param...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 23,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(trigger)",
            "context": ";\n      return;\n    }\n\n    // Enhanced keyboard navigation for accordion\n    accordionItems.forEach(function(trigger) {\n      // ARIA improvements\n      const targetId = trigger.getAttribute('data-acc...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 34,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "e', 'region');\n        \n        // Add focus management\n        trigger.addEventListener('keydown', function(e) {\n          const currentIndex = Array.from(accordionItems).indexOf(trigger);\n          ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 70,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "        // Enhanced click handling with animation support\n        trigger.addEventListener('click', function(e) {\n          e.preventDefault();\n          \n          const isExpanded = trigger.getAttri...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 84,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "   targetPanel.style.maxHeight = targetPanel.scrollHeight + 'px';\n            requestAnimationFrame(function() {\n              targetPanel.style.maxHeight = '0px';\n              targetPanel.style.opac...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 111,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "      }\n          }\n          \n          // Clean up maxHeight after animation\n          setTimeout(function() {\n            if (!isExpanded) {\n              targetPanel.style.maxHeight = 'none';\n    ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 121,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(trigger, index)",
            "context": "}, 300);\n        });\n      }\n    });\n\n    // Set up proper initial state\n    accordionItems.forEach(function(trigger, index) {\n      const targetId = trigger.getAttribute('data-accordion-target');\n   ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 146,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context)",
            "context": "length, 'items');\n  }\n\n  // Main Drupal behavior\n  Drupal.behaviors.adessoAccordion = {\n    attach: function (context) {\n      // Find accordion containers\n      const accordionElements = once('adesso...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 156,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(accordionElement)",
            "context": "esso-accordion] Found', accordionElements.length, 'accordion(s)');\n\n      accordionElements.forEach(function(accordionElement) {\n        initializeAccordion(accordionElement);\n      });\n    },\n\n    de...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 161,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings, trigger)",
            "context": "on(accordionElement) {\n        initializeAccordion(accordionElement);\n      });\n    },\n\n    detach: function (context, settings, trigger) {\n      if (trigger === 'unload') {\n        // Clean up event ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 166,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(accordion)",
            "context": "ions = context.querySelectorAll('[data-accordion=\"collapse\"]');\n        \n        accordions.forEach(function(accordion) {\n          const items = accordion.querySelectorAll('[data-accordion-target]');...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "components/accordion/accordion.behavior.js",
            "line": 168,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(item)",
            "context": "       const items = accordion.querySelectorAll('[data-accordion-target]');\n          items.forEach(function(item) {\n            // Reset inline styles\n            const targetId = item.getAttribute('...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.150Z"
      },
      {
        "file": "src/js/theme-customization.js",
        "vulnerabilitiesCount": 10,
        "vulnerabilities": [
          {
            "file": "src/js/theme-customization.js",
            "line": 104,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = html;",
            "context": "0.8;\">${color}</div>\n        </div>\n      `;\n    });\n    \n    html += '</div>';\n    previewContainer.innerHTML = html;\n  }\n\n  /**\n   * Update font preview.\n   */\n  function updateFontPreview(fontKey) ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 131,
            "pattern": "\\.innerHTML\\s*=\\s*[^;]+;",
            "risk": "HIGH",
            "category": "INNERHTML_ASSIGNMENT",
            "description": "Direct innerHTML assignment without sanitization",
            "match": ".innerHTML = `\n      <div style=\"margin-bottom: 8px;",
            "context": "`'${config.family}', ${config.fallback}`;\n    \n    // Update preview text content\n    previewElement.innerHTML = `\n      <div style=\"margin-bottom: 8px;\">\n        <strong>Font:</strong> ${config.famil...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 9,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal, once)",
            "context": "des live preview of color palettes and Google Fonts\n * in the theme settings admin interface.\n */\n\n(function (Drupal, once) {\n  'use strict';\n\n  /**\n   * Theme customization behavior.\n   */\n  Drupal.b...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 16,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings)",
            "context": " /**\n   * Theme customization behavior.\n   */\n  Drupal.behaviors.themeCustomization = {\n    attach: function (context, settings) {\n      once('theme-customization', 'form', context).forEach(function (...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 17,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (form)",
            "context": "  attach: function (context, settings) {\n      once('theme-customization', 'form', context).forEach(function (form) {\n        initializeThemeCustomization(form);\n      });\n    }\n  };\n\n  /**\n   * Initi...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 35,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "rPicker) {\n      updateColorPalette(colorPicker.value);\n      colorPicker.addEventListener('input', function(e) {\n        updateColorPalette(e.target.value);\n        updateLivePreview();\n      });\n   ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 44,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "ector) {\n      updateFontPreview(fontSelector.value);\n      fontSelector.addEventListener('change', function(e) {\n        updateFontPreview(e.target.value);\n        updateLivePreview();\n      });\n    ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 51,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(preset)",
            "context": "ePreview();\n      });\n    }\n\n    // Initialize municipality presets\n    municipalityPresets.forEach(function(preset) {\n      preset.addEventListener('change', function(e) {\n        if (e.target.checke...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 52,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": " presets\n    municipalityPresets.forEach(function(preset) {\n      preset.addEventListener('change', function(e) {\n        if (e.target.checked) {\n          applyMunicipalityPreset(e.target.value);\n   ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/theme-customization.js",
            "line": 61,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(e)",
            "context": "nitialize export functionality\n    if (exportButton) {\n      exportButton.addEventListener('click', function(e) {\n        e.preventDefault();\n        exportThemeSettings();\n      });\n    }\n\n    // Ini...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.161Z"
      },
      {
        "file": "src/js/tailwind.adesso.js",
        "vulnerabilitiesCount": 1,
        "vulnerabilities": [
          {
            "file": "src/js/tailwind.adesso.js",
            "line": 117,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function ({ matchUtilities, addBase, theme })",
            "context": "': '6rem',\n                '25': '6.25rem',\n            },\n        }\n    },\n  plugins: [\n    plugin(function ({ matchUtilities, addBase, theme }) {\n      matchUtilities(\n          {\n            stack:...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.167Z"
      },
      {
        "file": "src/js/lucide-init.behaviors.js",
        "vulnerabilitiesCount": 2,
        "vulnerabilities": [
          {
            "file": "src/js/lucide-init.behaviors.js",
            "line": 1,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal)",
            "context": "(function (Drupal) {\n  'use strict';\n\n  Drupal.behaviors.lucideIcons = {\n    attach: function (contex...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/lucide-init.behaviors.js",
            "line": 5,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings)",
            "context": "(function (Drupal) {\n  'use strict';\n\n  Drupal.behaviors.lucideIcons = {\n    attach: function (context, settings) {\n      if (typeof lucide !== 'undefined') {\n        lucide.createIcons...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.171Z"
      },
      {
        "file": "src/js/fix-block-reference-preview.js",
        "vulnerabilitiesCount": 6,
        "vulnerabilities": [
          {
            "file": "src/js/fix-block-reference-preview.js",
            "line": 5,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (Drupal)",
            "context": "/**\n * @file\n * Fixes frontend editing preview for entity reference autocomplete fields.\n */\n(function (Drupal) {\n  'use strict';\n\n  /**\n   * Attaches the fix for entity reference autocomplete f...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/fix-block-reference-preview.js",
            "line": 12,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function (context, settings)",
            "context": "plete fields in frontend editing.\n   */\n  Drupal.behaviors.fixBlockReferencePreview = {\n    attach: function (context, settings) {\n      // Find all entity reference autocomplete fields within fronten...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/fix-block-reference-preview.js",
            "line": 16,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(field)",
            "context": "ectorAll('.frontend-editing-form input.form-autocomplete');\n      \n      autocompleteFields.forEach(function(field) {\n        // Listen for autocomplete selection\n        field.addEventListener('autoc...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/fix-block-reference-preview.js",
            "line": 18,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": " {\n        // Listen for autocomplete selection\n        field.addEventListener('autocompleteclose', function() {\n          // Trigger the formUpdated event that frontend editing listens for\n          ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/fix-block-reference-preview.js",
            "line": 28,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "  });\n\n        // Also trigger on blur to catch manual edits\n        field.addEventListener('blur', function() {\n          setTimeout(function() {\n            const event = new CustomEvent('formUpdate...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/fix-block-reference-preview.js",
            "line": 29,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "blur to catch manual edits\n        field.addEventListener('blur', function() {\n          setTimeout(function() {\n            const event = new CustomEvent('formUpdated.formUpdatedEvent', {\n           ...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.184Z"
      },
      {
        "file": "src/js/adesso.js",
        "vulnerabilitiesCount": 4,
        "vulnerabilities": [
          {
            "file": "src/js/adesso.js",
            "line": 6,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function()",
            "context": "\n\n// Initialize Flowbite components when DOM is ready\ndocument.addEventListener('DOMContentLoaded', function() {\n\n  // Initialize dropdowns\n  initDropdowns();\n  \n  // Re-initialize after any dynamic c...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/adesso.js",
            "line": 12,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(mutations)",
            "context": "();\n  \n  // Re-initialize after any dynamic content changes\n  const observer = new MutationObserver(function(mutations) {\n    mutations.forEach(function(mutation) {\n      if (mutation.type === 'childL...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/adesso.js",
            "line": 13,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(mutation)",
            "context": "content changes\n  const observer = new MutationObserver(function(mutations) {\n    mutations.forEach(function(mutation) {\n      if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {\n  ...",
            "swissCompliance": "WARNING"
          },
          {
            "file": "src/js/adesso.js",
            "line": 16,
            "pattern": "Function\\s*\\([^)]*\\)",
            "risk": "HIGH",
            "category": "FUNCTION_CONSTRUCTOR",
            "description": "Function constructor usage - code injection risk",
            "match": "function(node)",
            "context": "{\n        // Check if any added nodes contain dropdown triggers\n        mutation.addedNodes.forEach(function(node) {\n          if (node.nodeType === 1) { // Element node\n            const dropdownTrig...",
            "swissCompliance": "WARNING"
          }
        ],
        "riskLevel": "HIGH",
        "scanTimestamp": "2025-08-30T16:39:14.189Z"
      }
    ],
    "userContentVulnerabilities": [
      {
        "file": "components/sidebyside/sidebyside.twig",
        "line": 23,
        "risk": "CRITICAL",
        "category": "USER_CONTENT_RAW",
        "description": "User content with raw filter - citizen data XSS vulnerability",
        "context": "USER_GENERATED",
        "priority": "IMMEDIATE",
        "match": "{{ text|raw }}",
        "citizenDataRisk": true,
        "swissComplianceViolation": true
      }
    ]
  },
  "swissCompliance": {
    "compliant": false,
    "percentage": 0,
    "passedChecks": 0,
    "totalChecks": 6,
    "checks": {
      "noCriticalXSSVulnerabilities": false,
      "noUserContentXSS": false,
      "limitedHighRiskVulnerabilities": false,
      "citizenDataProtectionCompliant": false,
      "municipalPortalSecurityStandards": false,
      "xssPreventionImplemented": false
    },
    "criticalIssues": 17,
    "userContentRisk": 1,
    "recommendationsCount": 6
  },
  "recommendations": [
    {
      "priority": "IMMEDIATE",
      "category": "CRITICAL_XSS",
      "title": "Fix Critical XSS Vulnerabilities",
      "description": "Remove |raw filters from user content contexts immediately",
      "impact": "Swiss government compliance violation - citizen data at risk",
      "action": "Replace |raw filters with proper escaping or sanitization"
    },
    {
      "priority": "HIGH",
      "category": "USER_CONTENT",
      "title": "Secure User Content Rendering",
      "description": "Implement proper escaping for all user-generated content",
      "impact": "Citizen data protection and municipal portal security",
      "action": "Use Twig auto-escaping, validate and sanitize user input"
    },
    {
      "priority": "HIGH",
      "category": "XSS_PREVENTION",
      "title": "Implement Comprehensive XSS Prevention",
      "description": "Address high-risk XSS patterns in templates and scripts",
      "impact": "Government security standards compliance",
      "action": "Replace unsafe patterns, implement CSP headers"
    },
    {
      "priority": "MEDIUM",
      "category": "SECURITY_HEADERS",
      "title": "Implement Security Headers",
      "description": "Add Content Security Policy and XSS protection headers",
      "impact": "Enhanced XSS protection for municipal portals",
      "action": "Configure CSP headers, X-XSS-Protection, X-Content-Type-Options"
    },
    {
      "priority": "MEDIUM",
      "category": "INPUT_VALIDATION",
      "title": "Enhance Input Validation",
      "description": "Implement server-side input validation and sanitization",
      "impact": "Citizen data protection and form security",
      "action": "Add input validation, CSRF protection, sanitization filters"
    },
    {
      "priority": "LOW",
      "category": "MONITORING",
      "title": "Implement XSS Monitoring",
      "description": "Set up automated XSS vulnerability monitoring",
      "impact": "Ongoing security maintenance for government portals",
      "action": "Schedule regular scans, implement security monitoring"
    }
  ],
  "municipalContext": {
    "componentsScannd": 112,
    "governmentSecurityStandards": "eCH-0194",
    "citizenDataProtection": "GDPR + Swiss DPA",
    "portalTypes": [
      "Thalwil Municipality",
      "Thalheim Municipality",
      "Erlenbach Municipality"
    ]
  },
  "nextSteps": [
    "Address critical XSS vulnerabilities immediately",
    "Implement Content Security Policy headers",
    "Enhance user content sanitization",
    "Schedule monthly XSS security scans",
    "Train development team on XSS prevention"
  ]
}