{#
/**
 * @file
 * Theme override to display an article node with page header.
 */
#}
{%
  set classes = [
    'node',
    'node--type-' ~ node.bundle|clean_class,
    node.isPromoted() ? 'node--promoted',
    node.isSticky() ? 'node--sticky',
    not node.isPublished() ? 'node--unpublished',
    view_mode ? 'node--view-mode-' ~ view_mode|clean_class,
  ]
%}

{# Page Header Section with article-specific fields #}
{% set page_description = '' %}
{% if node.hasField('field_lead') and node.field_lead.value %}
  {% set page_description = node.field_lead.value %}
{% elseif node.hasField('field_subhead') and node.field_subhead.value %}
  {% set page_description = node.field_subhead.value %}
{% endif %}

{% set header_image = '' %}
{% set header_alt = '' %}
{% if node.hasField('field_media') and node.field_media.entity and node.field_media.entity.bundle == 'image' %}
  {% set header_image = file_url(node.field_media.entity.field_media_image.entity.fileuri) %}
  {% set header_alt = node.field_media.entity.field_media_image.alt|default('') %}
{% endif %}

{% include 'adesso_cms_theme:page-header' with {
  title: label,
  description: page_description,
  background_image: header_image,
  alt_text: header_alt
} %}

<article{{ attributes.addClass(classes) }}>
  <div class="container mx-auto px-4">
    
    <div class="max-w-screen-lg mx-auto">
      {{ title_prefix }}
      {# Title is now handled by the page header component above #}
      {{ title_suffix }}

      <div class="prose prose-lg max-w-screen-md mx-auto mt-8">
        {{ content|without('field_subhead', 'field_lead', 'field_tags', 'field_authors', 'field_media') }}
      </div>
    </div>
  </div>
</article>
