{#
/**
 * @file
 * Specialized Remote Video Media Template
 * 
 * Enhanced remote video handling (YouTube, Vimeo) with privacy controls,
 * GDPR compliance, and Swiss municipal standards.
 * 
 * Available variables:
 * - All variables from main media component schema
 * - Enhanced privacy and consent management
 */
#}

{# Enhanced remote video with privacy-first approach for Swiss municipal compliance #}
<div class="adesso-media__remote-video border border-gray-300 rounded-lg overflow-hidden bg-white shadow-sm">
  
  {# Privacy consent interface (shown before loading external content) #}
  {% if external_content and not gdpr_compliant %}
    <div class="adesso-media__external-consent bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-dashed border-blue-200 rounded-lg">
      
      {# Video preview/thumbnail if available #}
      <div class="relative">
        {% if media_entity.thumbnail %}
          <img 
            src="{{ media_entity.thumbnail }}" 
            alt="{{ resolved_alt_text|default('Video thumbnail')|striptags }}"
            class="w-full h-48 object-cover rounded-t-lg"
          />
        {% else %}
          {# Fallback video placeholder #}
          <div class="w-full h-48 bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center rounded-t-lg">
            <div class="text-center text-gray-600">
              <svg class="w-16 h-16 mx-auto mb-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M8 5v14l11-7z"/>
              </svg>
              <p class="text-sm font-medium">{{ 'External Video'|t }}</p>
            </div>
          </div>
        {% endif %}
        
        {# Play button overlay #}
        <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center">
          <div class="bg-white bg-opacity-90 rounded-full p-4">
            <svg class="w-12 h-12 text-gray-800" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M8 5v14l11-7z"/>
            </svg>
          </div>
        </div>
        
        {# External content badge #}
        <div class="absolute top-2 right-2 bg-yellow-400 text-yellow-900 px-2 py-1 rounded-full text-xs font-semibold">
          {{ 'External'|t }}
        </div>
      </div>
      
      {# Consent and information section #}
      <div class="p-6">
        
        {# Video information #}
        <div class="mb-4">
          <h3 class="text-lg font-semibold text-gray-900 mb-1">
            {{ resolved_alt_text|default('External Video Content')|striptags }}
          </h3>
          {% if resolved_caption %}
            <p class="text-gray-700 text-sm">{{ resolved_caption|striptags }}</p>
          {% endif %}
        </div>
        
        {# Privacy notice #}
        <div class="bg-white border border-blue-200 rounded-lg p-4 mb-4">
          <div class="flex items-start">
            <svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
            <div>
              <h4 class="font-medium text-gray-900 mb-1">{{ 'Privacy Information'|t }}</h4>
              <p class="text-sm text-gray-700 mb-2">
                {{ 'This content is hosted on an external platform and may:'|t }}
              </p>
              <ul class="text-sm text-gray-600 list-disc list-inside space-y-1">
                <li>{{ 'Set cookies and track your viewing behavior'|t }}</li>
                <li>{{ 'Share your IP address and browser information'|t }}</li>
                <li>{{ 'Apply different privacy policies'|t }}</li>
                <li>{{ 'Show targeted advertisements'|t }}</li>
              </ul>
            </div>
          </div>
        </div>
        
        {# Platform-specific information #}
        {% set video_platform = 'unknown' %}
        {% if media_entity.uri matches '/youtube|youtu\.be/i' %}
          {% set video_platform = 'youtube' %}
        {% elseif media_entity.uri matches '/vimeo/i' %}
          {% set video_platform = 'vimeo' %}
        {% elseif media_entity.uri matches '/dailymotion/i' %}
          {% set video_platform = 'dailymotion' %}
        {% endif %}
        
        {% if video_platform != 'unknown' %}
          <div class="flex items-center mb-4 text-sm text-gray-600">
            <span class="font-medium mr-2">{{ 'Platform'|t }}:</span>
            {% if video_platform == 'youtube' %}
              <span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-medium">YouTube (Google)</span>
              <a 
                href="https://policies.google.com/privacy" 
                target="_blank" 
                rel="noopener noreferrer"
                class="ml-2 text-blue-600 hover:text-blue-800 underline text-xs"
              >
                {{ 'Privacy Policy'|t }}
              </a>
            {% elseif video_platform == 'vimeo' %}
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium">Vimeo</span>
              <a 
                href="https://vimeo.com/privacy" 
                target="_blank" 
                rel="noopener noreferrer"
                class="ml-2 text-blue-600 hover:text-blue-800 underline text-xs"
              >
                {{ 'Privacy Policy'|t }}
              </a>
            {% endif %}
          </div>
        {% endif %}
        
        {# Consent actions #}
        <div class="flex flex-wrap gap-3 justify-center">
          <button 
            type="button"
            class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 font-medium transition-colors"
            data-load-external-media="{{ media_entity.uri }}"
            data-consent-given="true"
            aria-describedby="{{ media_id }}-external-desc"
          >
            <span class="flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M8 5v14l11-7z"/>
              </svg>
              {{ 'Accept and Load Video'|t }}
            </span>
          </button>
          
          {% if media_entity.uri %}
            <a 
              href="{{ media_entity.uri }}" 
              target="_blank" 
              rel="noopener noreferrer"
              class="bg-gray-200 text-gray-800 px-6 py-3 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 font-medium transition-colors"
            >
              <span class="flex items-center">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                </svg>
                {{ 'Open on'|t }} {{ video_platform|title }}
              </span>
            </a>
          {% endif %}
        </div>
        
        {# Consent description for screen readers #}
        <div id="{{ media_id }}-external-desc" class="sr-only">
          {{ 'By clicking "Accept and Load Video", you consent to loading content from'|t }} {{ video_platform|title }}.
          {{ 'This will share your data with the external platform according to their privacy policy.'|t }}
          {{ 'Alternatively, you can open the video directly on the external platform.'|t }}
        </div>
        
      </div>
    </div>
    
  {% else %}
    {# Direct embedding when privacy consent is not required #}
    <div class="adesso-media__embedded-content">
      {{ media_entity|view(display_mode|default('default')) }}
    </div>
  {% endif %}
  
  {# Enhanced iframe container for loaded external content #}
  <div class="adesso-media__iframe-container hidden" data-iframe-container>
    {# Dynamic content will be inserted here by JavaScript #}
  </div>
  
</div>

{# Additional metadata for external content #}
{% if external_content %}
  <div class="adesso-media__external-metadata mt-3 text-xs text-gray-600">
    <div class="flex flex-wrap items-center gap-4">
      
      {# External content indicator #}
      <div class="flex items-center">
        <svg class="w-3 h-3 mr-1 text-yellow-600" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" />
        </svg>
        <span>{{ 'External Content'|t }}</span>
      </div>
      
      {# Last updated information #}
      {% if media_entity.changed %}
        <div class="flex items-center">
          <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span>{{ 'Updated'|t }}: {{ media_entity.changed|date('d.m.Y') }}</span>
        </div>
      {% endif %}
      
      {# Privacy level indicator #}
      <div class="flex items-center">
        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
        </svg>
        <span class="capitalize">{{ privacy_level|t }} {{ 'Content'|t }}</span>
      </div>
      
    </div>
  </div>
{% endif %}

{# Swiss municipal compliance footer #}
<div class="adesso-media__compliance-footer mt-2 text-xs text-gray-500 border-t border-gray-100 pt-2">
  <p>
    <strong>{{ 'Municipal Compliance'|t }}:</strong>
    {{ 'This content meets Swiss municipal standards for external media handling.'|t }}
    {% if not gdpr_compliant %}
      {{ 'User consent is required before loading external resources.'|t }}
    {% endif %}
  </p>
</div>