{% import _self as macros %}

{% macro render_content(pre_headline, title, body) %}
  {% if pre_headline or title %}
    {% include 'adesso_cms_theme:section-header' with {
      title: title,
      pre_headline: pre_headline,
      alignment: 'left',
      title_tag: 'h2',
      pre_headline_tag: 'span',
      title_visual_level: '2',
      pre_headline_visual_level: '3',
      additional_classes: 'mb-4'
    } %}
  {% endif %}

  {% if body|default('') %}
    <div class="max-w-none prose prose-lg mt-4 ">
      {{ body|default('')|render }}
    </div>
  {% endif %}
{% endmacro %}

{% macro render_buttons(link1, link2, text_layout) %}
  {% if (link1|default({}) and link1.url|default('')) or (link2|default({}) and link2.url|default('')) %}
    {% set buttonContainerClasses = 'text-buttons mt-6 flex' %}

    {% if (text_layout|default('')) == 'centered' %}
      {% set buttonContainerClasses = buttonContainerClasses ~ ' justify-center' %}
    {% elseif (text_layout|default('')) == 'buttons-right' %}
      {% set buttonContainerClasses = buttonContainerClasses ~ ' justify-start lg:justify-end' %}
    {% else %}
      {% set buttonContainerClasses = buttonContainerClasses ~ ' justify-start' %}
    {% endif %}

    <div class="{{ buttonContainerClasses }}">
      {% if link1|default({}) and link1.url|default('') %}
        {% include 'adesso_cms_theme:button' with {
					"url": link1.url|default(''),
					"text": (link1.text|default('')) ? (link1.text|default('')) : 'Read more'|t,
					"modifier": "text-primary-link mr-4",
					"variant": "default"
        } only %}
      {% endif %}

      {% if link2|default({}) and link2.url|default('') %}
        {% include 'adesso_cms_theme:button' with {
					"url": link2.url|default(''),
					"text": (link2.text|default('')) ? (link2.text|default('')) : 'Read more'|t,
					"modifier": "text-secondary-link",
					"variant": "secondary"
        } only %}
      {% endif %}
    </div>
  {% endif %}
{% endmacro %}

<div class="text-container {{ className|default('') }}">
  {% if (text_layout|default('')) == 'buttons-right' %}
    <div class="lg:flex lg:items-start lg:justify-between">
      <div class="lg:flex-grow">
        {{ macros.render_content(pre_headline|default(''), title|default(''), body|default('')) }}
      </div>

      {% if link.url|default('') or link2.url|default('') %}
        <div class="lg:ml-8 lg:flex-shrink-0 lg:self-start">
          {{ macros.render_buttons(link|default({}), link2|default({}), text_layout|default('')) }}
        </div>
      {% endif %}
    </div>
  {% else %}
    <div class="container {{ (text_layout|default('')) == 'centered' ? 'mx-auto text-center' : '' }}">
      {{ macros.render_content(pre_headline|default(''), (heading|default('')) ?: (title|default('')), body|default('')) }}

      {% if heading|default('') and (text_layout|default('')) != 'buttons-right' %}
        {% include 'adesso_cms_theme:heading' with {
          "heading": heading|default('')
        } only %}
      {% endif %}

      {{ macros.render_buttons(link|default({}), link2|default({}), text_layout|default('')) }}
    </div>
  {% endif %}
</div>
